---
title: "Entanglement Model"
output: html_document
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
```
***
#### The Entanglement Model (ModelEntangle) is an object of class *rfPermute* that includes known-outcome entanglement injury cases, included as the data.frame *data.entangle* in the R-Package *SeriousInjury*.

```
# Create randomForest model (using R-Package rfPermute) using known-outcome entanglement strike data

# make sure you have devtools installed
if (!require('devtools')) install.packages('devtools')

# install from GitHub
devtools::install_github('EricArcher/rfPermute')

library(rfPermute)

# set.seed for reproducibility
set.seed(123)

# how many RF trees to build
size.RF = 1000

# covariates included in ModelEntangle

entangle.covariates = which(names(data.entangle)%in%c("anchored", "calf.juv", "constricting", "decline", "extensive.severe", "fluke.peduncle", "gear.free", "head", "healing", "laceration.deep",
                                                    "laceration.shallow", "pectoral", "swim.dive", "trailing", "wraps.multi", "wraps.no"))

# balance sample size for each class; we are equally-interested in correctly      
#  predicting non-serious and serious injuries
 
sampsize = balancedSampsize(data.entangle$Health.status)

# RF Entanglement model

ModelEntanglement = rfPermute(data.entangle$Health.status ~ .,
 data.entangle[,entangle.covariates], sampsize=sampsize, ntree=size.RF, 
  replace=FALSE, importance=TRUE, proximity=TRUE)
  
# RF Entanglement model Confusion Matrix
ModelEntanglement
 
```




---
title: 'Injury Covariates'
output: html_document
---
****
#### Covariates are derived from injury narratives with the function '*WhaleInjuryCovariates()*'. Code to define, maintain, and extract covariates from narratives is found in the R-script *Large Whale Injury Covariates.R*. Covariates are defined below, followed by example code defining the covariate *decline*, coding it as a presence / absence value, and appending these values to the data.frame '*LargeWhaleData*'.
  
****
  
#### Definitions:

#### <b>*anchored*</b>
<p>Evidence a whale was anchored or immobilized by                                entangling material or gear.  Narrative mentions                                  inability to dive or swim or that whale is                                        immobilized. Includes references to a                                             heavily-weighted whale with multiple pots/traps                                   impeding normal movement.</p>

#### <b>*calf.juv*</b>
<p>Narrative includes reference to an injured calf or juvenile. Also includes narratives where injury involves the mother of a dependent calf.</p>

#### <b>*constricting*</b>
<p>Evidence of a constricting entanglement, including line cutting into whale, wrapped tightly around body or flippers.</p>

#### <b>*decline*</b>
<p>Narrative includes evidence of a health decline, such as the presence of cyamids, emaciation, discolored skin, deformities caused by a chronic entanglement or severe vessel strike incident.</p>

#### <b>*extensive.severe*</b>	
<p>Evidence of severe injury that can include amputation or necrosis of body parts due to a chronic entanglement or acute vessel strike injury.</p> 

#### <b>*fluke.peduncle*</b>
<p>Narrative includes reference of entanglement or vessel strike injury that involves the tail, flukes, or peduncle.</p>

#### <b>*gear.free*</b>	
<p>Evidence that the whale freed itself from the gear or entangling material. Typically involves a whale resighted at a later date than the initial entanglement observation.</p>

#### <b>*head*</b>	
<p>Narrative indicates that the head, mouth, or blowhole was involved in the entanglement or vessel strike injury.</p>

#### <b>*healing*</b>
<p>Narrative refers to healing or healed wounds.</p>

#### <b>*laceration.deep*</b>
<p>Narrative includes reference to deep laceration resulting from vessel strike or entanglement. May include reference to blubber or muscle layers.</p>

#### <b>*laceration.shallow*</b>
<p>Narrative includes reference to shallow or superficial lacerations.</p>

#### <b>*pectoral*</b>
<p>Narrative includes involvement of pectoral flipper or ‘fins’ in entanglement or vessel strike injury.</p>

#### <b>*swim.dive*</b>
<p>Evidence that the whale is swimming, feeding, or diving normally.</p>

#### <b>*trailing*</b>			
<p>Was the whale trailing gear or other entangling material?</p>

#### <b>*vessel.fast*</b>
<p>Narrative includes reference to vessel speeds < 10 kts.</p>

#### <b>*vessel.large*</b>
<p>Narrative includes reference to large vessels such as military vessels, ferries, container ships, or vessel >65 ft in length.</p>

#### <b>*vessel.slow*</b>
<p>Narrative includes reference to vessel speeds >= 10 kts.</p>

#### <b>*vessel.small*</b>
<p>Narrative includes reference to small vessels such as sailboats, recreational vessels, RHIB vessels, or vessel size < 65 ft in length or smaller than the whale, if this can be determined.</p>

#### <b>*wraps.multi*</b>
<p>Narrative includes reference to whale with  multiple wraps of line or gear around body or appendage.</p>

#### <b>*wraps.no*</b>
<p>Narrative includes reference to a whale without any wraps of line or gear around body or appendage.</p>

<br><br>

```
# To install the latest *SeriousInjury* version from GitHub:

# make sure you have devtools installed
if (!require('devtools')) install.packages('devtools')

# install from GitHub
devtools::install_github('JimCarretta/SeriousInjury')

# Example code to identify covariate 'decline' from injury narratives in data.frame 'LargeWhaleData'.
#   function WhaleInjuryCovariates() applied to data.frame 'LargeWhaleData'
#    data.frame narrative field must be named 'Narrative' for use with WhaleInjuryCovariates().
#     use function 'grepl' to search for words/phrases in 'Narrative'.
#      code covariates numerically as 1/0, aligned with their TRUE/FALSE (=presence/absence) state.

# Evidence of a health decline? 
#  Search 'Narrative' for words/phrases associated with health declines.
    
    decline <- grepl(" abnormal|chronic|deteriorat|fair|
     compromise|scoliosis|deform|cyamid|lice|lethargic|
      lesion|discolor|diatom|poor cond|poor health|poor body|
       poor over|poor skin|rake|skin|slough|thin |emaciated|malnourish|
        underweight|starv|mobility", LargeWhaleData$Narrative, ignore.case=T)
    
    decline <- as.numeric(lapply(decline, as.numeric))
     decline
    
# Use WhaleInjuryCovariates() to append all covariates to each row of 'LargeWhaleData' 
    
    head(LargeWhaleData)

    new.data.frame <- WhaleInjuryCovariates(LargeWhaleData)

    head(new.data.frame)
    
```

